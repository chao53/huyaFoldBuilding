
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/eventSystem.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '59df4Wq2V1Ij7FfbTDyPpKA', 'eventSystem');
// scripts/eventSystem.js

"use strict";

cc.Class({
  "extends": cc.Component,
  properties: {
    scoreDisplay: {
      "default": null,
      type: cc.Label
    },
    background: {
      "default": null,
      type: cc.Node
    },
    gameOverPanle: {
      "default": null,
      type: cc.Layout
    },
    gameOverPanle_failed: {
      "default": null,
      type: cc.Layout
    },
    gameOverScore: {
      "default": null,
      type: cc.Label
    },
    floorPrefab: {
      "default": null,
      type: cc.Prefab
    },
    fakefloor: {
      "default": null,
      type: cc.Node
    },
    rope: {
      "default": null,
      type: cc.Node
    },
    lastfloor: {
      "default": null,
      type: cc.Node
    },
    particlePrefab: {
      "default": null,
      type: cc.Prefab
    },
    particlePrefab2: {
      "default": null,
      type: cc.Prefab
    },
    particlePrefab3: {
      "default": null,
      type: cc.Prefab
    },
    layoutStart: {
      "default": null,
      type: cc.Layout
    },
    time: {
      "default": null,
      type: cc.Label
    },
    music: {
      "default": null,
      type: cc.AudioClip
    },
    effect: {
      "default": null,
      type: cc.AudioClip
    },
    effect1: {
      "default": null,
      type: cc.AudioClip
    },
    perfect: {
      "default": null,
      type: cc.Node
    },
    flag: true
  },
  onLoad: function onLoad() {
    // this.choice = true;
    this.isPerfect = false;
    this.flag_number = 0;
    this.flag_start = false;
    this.isOver = false;
    this.count = 60;
    this.score = 0;
    this.fallside = 0;
    this.angleSpeed = 0;
    this.angleTimer = 0;
    this.shakeAnglespeed = 0;
    this.perfect.active = false;
    this.node.on('touchend', function (event) {
      if (this.flag && !this.isOver && this.flag_start) {
        this.spawnNewFloor();
      }
    }.bind(this));
    this.node.on('mousedown', function (event) {
      if (this.flag && !this.isOver && this.flag_start) {
        this.spawnNewFloor();
      }
    }.bind(this));
  },
  // LIFE-CYCLE CALLBACKS:
  start: function start() {},
  spawnNewFloor: function spawnNewFloor() {
    // 使用给定的模板在场景中生成一个新节点
    var newfloor = cc.instantiate(this.floorPrefab);
    this.node.addChild(newfloor);
    newfloor.getComponent('floorScript').bindnode(this.lastfloor, this.node);
    newfloor.getComponent('floorScript').changeSprite(this.fakefloor.getComponent('fakefloorScript').id);
    this.lastfloor = newfloor;
    newfloor.setPosition(this.fakefloor.convertToWorldSpaceAR(cc.v2(-630 + 3300 * Math.sin(this.node.angle * Math.PI / 180), 1840)));
    this.hideFakeFloor();
  },
  hideFakeFloor: function hideFakeFloor() {
    this.flag = false;
    var self = this;
    console.debug("0");
    this.scheduleOnce(function () {
      var newPar = cc.instantiate(self.particlePrefab);
      this.current = cc.audioEngine.play(this.effect, false, 0.3); //

      self.node.addChild(newPar);
      newPar.setPosition(cc.v2(0, 2590, 0));
      var newPar2 = cc.instantiate(self.particlePrefab2);
      self.node.addChild(newPar2);
      newPar2.setPosition(cc.v2(0, 2590, 0));
      console.debug('particles');
    }, 0.4);
    this.background.getComponent('BackChange').scheduleOnce(function () {
      this.startdown();
      self.changeWaveSpeed();

      if (self.isPerfect) {
        self.changeScore();
        console.debug("perfect");
        var newPar3 = cc.instantiate(self.particlePrefab3);
        self.node.addChild(newPar3);
        newPar3.setPosition(cc.v2(0, 3300, 0));
        console.debug('flower'); //this.getComponent('GreatWork').scheduleOnce(function() {
        //console.debug("create particle");
        //this.create();
        //}, 0.4)
      }

      self.isPerfect = false;
    }, 0.7); //console.debug("1");

    this.scheduleOnce(function () {
      if (self.isPerfect) {
        this.current1 = cc.audioEngine.play(this.effect1, false, 0.5); //第二个音效

        this.perfect.active = false;
      }
    }, 0.7);
    this.lastfloor.getComponent('floorScript').scheduleOnce(function () {
      this.changeState();
    }, 0.7);
    this.fakefloor.getComponent('fakefloorScript').changeTexture(1);
    this.fakefloor.getComponent('fakefloorScript').scheduleOnce(function () {
      // 这里的 this 指向 component
      this.changeTexture(2);

      if (!self.isOver) {
        self.flag = true;
        self.changeScore();
      }
    }, 0.7);
  },
  changeWaveSpeed: function changeWaveSpeed() {
    if (this.score <= 50) {
      this.rope.getComponent('pendulumScript').changeSpeed(this.score / 20 + 1.5);
      this.fakefloor.getComponent('pendulumScript').changeSpeed(this.score / 20 + 1.5);
    }
  },
  VeryPerfect: function VeryPerfect() {
    this.perfect.active = true;
    this.isPerfect = true;
  },
  changeScore: function changeScore() {
    this.score++;
    this.scoreDisplay.string = 'Score: ' + this.score;
  },
  gameOver: function gameOver() {
    if (!this.isOver) {
      this.isOver = true;
    }

    if (this.flag_number == 0) {
      this.scheduleOnce(function () {
        this.gameOverPanle.node.active = true;
        this.gameOverScore.string = this.score;
        this.gameOverScore.node.active = true;
        console.debug("panel_end");
      }, 1.5);
    }

    if (this.flag_number == 1) {
      this.scheduleOnce(function () {
        this.gameOverPanle_failed.node.active = true;
        this.gameOverScore.string = this.score;
        this.gameOverScore.node.active = true;
        console.debug("panel_fail");
      }, 1.5);
    }
  },
  falldown: function falldown(i) {
    if (!this.isOver) {
      this.fallside = i; // this.choice = false;

      this.gameOver();
    }
  },
  LayoutOn: function LayoutOn() {
    this.layoutStart.node.active = true;
  },
  LayoutOff: function LayoutOff() {
    this.layoutStart.node.active = false;
    this.flag_start = true; // console.debug("close");
  },
  buttonOne: function buttonOne() {
    this.LayoutOff();
    this.time.string = ''; // console.debug('button one')
  },
  buttonTwo: function buttonTwo() {
    this.flag_number = 1;
    this.choice = false;
    this.LayoutOff();
    this.iniTime();
  },
  iniTime: function iniTime() {
    // if (this.count >= 0) {
    this.schedule(function () {
      this.countdown();
    }, 1); // }
  },
  countdown: function countdown() {
    if (this.count >= 1) {
      this.count = this.count - 1;
      this.time.string = this.count + 's';
      cc.log("countdown:" + this.count);
    } else {
      this.flag_number = 0;
      this.gameOver();
    }
  },
  restar: function restar() {
    this.gameOverScore.node.active = false;
    cc.director.loadScene('1');
  },
  update: function update(dt) {
    if (this.fallside == 1) {
      if (this.node.angle < 90) {
        this.angleSpeed += 50 * dt;
        this.node.angle += this.angleSpeed * dt;
      }
    } else if (this.fallside == -1) {
      if (this.node.angle > -90) {
        this.angleSpeed += 50 * dt;
        this.node.angle -= this.angleSpeed * dt;
      }
    } else if (this.score >= 5 && this.score <= 35) {
      this.angleTimer += dt;
      this.shakeAnglespeed = Math.cos(this.angleTimer);
      this.node.angle += this.shakeAnglespeed * (this.score / 5) * dt;
    } else if (this.score >= 35) {
      this.angleTimer += dt;
      this.shakeAnglespeed = Math.cos(this.angleTimer);
      this.node.angle += this.shakeAnglespeed * 5 * dt;
    }
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcZXZlbnRTeXN0ZW0uanMiXSwibmFtZXMiOlsiY2MiLCJDbGFzcyIsIkNvbXBvbmVudCIsInByb3BlcnRpZXMiLCJzY29yZURpc3BsYXkiLCJ0eXBlIiwiTGFiZWwiLCJiYWNrZ3JvdW5kIiwiTm9kZSIsImdhbWVPdmVyUGFubGUiLCJMYXlvdXQiLCJnYW1lT3ZlclBhbmxlX2ZhaWxlZCIsImdhbWVPdmVyU2NvcmUiLCJmbG9vclByZWZhYiIsIlByZWZhYiIsImZha2VmbG9vciIsInJvcGUiLCJsYXN0Zmxvb3IiLCJwYXJ0aWNsZVByZWZhYiIsInBhcnRpY2xlUHJlZmFiMiIsInBhcnRpY2xlUHJlZmFiMyIsImxheW91dFN0YXJ0IiwidGltZSIsIm11c2ljIiwiQXVkaW9DbGlwIiwiZWZmZWN0IiwiZWZmZWN0MSIsInBlcmZlY3QiLCJmbGFnIiwib25Mb2FkIiwiaXNQZXJmZWN0IiwiZmxhZ19udW1iZXIiLCJmbGFnX3N0YXJ0IiwiaXNPdmVyIiwiY291bnQiLCJzY29yZSIsImZhbGxzaWRlIiwiYW5nbGVTcGVlZCIsImFuZ2xlVGltZXIiLCJzaGFrZUFuZ2xlc3BlZWQiLCJhY3RpdmUiLCJub2RlIiwib24iLCJldmVudCIsInNwYXduTmV3Rmxvb3IiLCJiaW5kIiwic3RhcnQiLCJuZXdmbG9vciIsImluc3RhbnRpYXRlIiwiYWRkQ2hpbGQiLCJnZXRDb21wb25lbnQiLCJiaW5kbm9kZSIsImNoYW5nZVNwcml0ZSIsImlkIiwic2V0UG9zaXRpb24iLCJjb252ZXJ0VG9Xb3JsZFNwYWNlQVIiLCJ2MiIsIk1hdGgiLCJzaW4iLCJhbmdsZSIsIlBJIiwiaGlkZUZha2VGbG9vciIsInNlbGYiLCJjb25zb2xlIiwiZGVidWciLCJzY2hlZHVsZU9uY2UiLCJuZXdQYXIiLCJjdXJyZW50IiwiYXVkaW9FbmdpbmUiLCJwbGF5IiwibmV3UGFyMiIsInN0YXJ0ZG93biIsImNoYW5nZVdhdmVTcGVlZCIsImNoYW5nZVNjb3JlIiwibmV3UGFyMyIsImN1cnJlbnQxIiwiY2hhbmdlU3RhdGUiLCJjaGFuZ2VUZXh0dXJlIiwiY2hhbmdlU3BlZWQiLCJWZXJ5UGVyZmVjdCIsInN0cmluZyIsImdhbWVPdmVyIiwiZmFsbGRvd24iLCJpIiwiTGF5b3V0T24iLCJMYXlvdXRPZmYiLCJidXR0b25PbmUiLCJidXR0b25Ud28iLCJjaG9pY2UiLCJpbmlUaW1lIiwic2NoZWR1bGUiLCJjb3VudGRvd24iLCJsb2ciLCJyZXN0YXIiLCJkaXJlY3RvciIsImxvYWRTY2VuZSIsInVwZGF0ZSIsImR0IiwiY29zIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBQSxFQUFFLENBQUNDLEtBQUgsQ0FBUztBQUNMLGFBQVNELEVBQUUsQ0FBQ0UsU0FEUDtBQUdMQyxFQUFBQSxVQUFVLEVBQUU7QUFDUkMsSUFBQUEsWUFBWSxFQUFFO0FBQ1YsaUJBQVMsSUFEQztBQUVWQyxNQUFBQSxJQUFJLEVBQUVMLEVBQUUsQ0FBQ007QUFGQyxLQUROO0FBS1JDLElBQUFBLFVBQVUsRUFBRTtBQUNSLGlCQUFTLElBREQ7QUFFUkYsTUFBQUEsSUFBSSxFQUFFTCxFQUFFLENBQUNRO0FBRkQsS0FMSjtBQVNSQyxJQUFBQSxhQUFhLEVBQUU7QUFDWCxpQkFBUyxJQURFO0FBRVhKLE1BQUFBLElBQUksRUFBRUwsRUFBRSxDQUFDVTtBQUZFLEtBVFA7QUFhUkMsSUFBQUEsb0JBQW9CLEVBQUU7QUFDbEIsaUJBQVMsSUFEUztBQUVsQk4sTUFBQUEsSUFBSSxFQUFFTCxFQUFFLENBQUNVO0FBRlMsS0FiZDtBQWlCUkUsSUFBQUEsYUFBYSxFQUFFO0FBQ1gsaUJBQVMsSUFERTtBQUVYUCxNQUFBQSxJQUFJLEVBQUVMLEVBQUUsQ0FBQ007QUFGRSxLQWpCUDtBQXFCUk8sSUFBQUEsV0FBVyxFQUFFO0FBQ1QsaUJBQVMsSUFEQTtBQUVUUixNQUFBQSxJQUFJLEVBQUVMLEVBQUUsQ0FBQ2M7QUFGQSxLQXJCTDtBQTBCUkMsSUFBQUEsU0FBUyxFQUFFO0FBQ1AsaUJBQVMsSUFERjtBQUVQVixNQUFBQSxJQUFJLEVBQUVMLEVBQUUsQ0FBQ1E7QUFGRixLQTFCSDtBQStCUlEsSUFBQUEsSUFBSSxFQUFFO0FBQ0YsaUJBQVMsSUFEUDtBQUVGWCxNQUFBQSxJQUFJLEVBQUVMLEVBQUUsQ0FBQ1E7QUFGUCxLQS9CRTtBQW9DUlMsSUFBQUEsU0FBUyxFQUFFO0FBQ1AsaUJBQVMsSUFERjtBQUVQWixNQUFBQSxJQUFJLEVBQUVMLEVBQUUsQ0FBQ1E7QUFGRixLQXBDSDtBQXlDUlUsSUFBQUEsY0FBYyxFQUFFO0FBQ1osaUJBQVMsSUFERztBQUVaYixNQUFBQSxJQUFJLEVBQUVMLEVBQUUsQ0FBQ2M7QUFGRyxLQXpDUjtBQThDUkssSUFBQUEsZUFBZSxFQUFFO0FBQ2IsaUJBQVMsSUFESTtBQUViZCxNQUFBQSxJQUFJLEVBQUVMLEVBQUUsQ0FBQ2M7QUFGSSxLQTlDVDtBQW1EUk0sSUFBQUEsZUFBZSxFQUFFO0FBQ2IsaUJBQVMsSUFESTtBQUViZixNQUFBQSxJQUFJLEVBQUVMLEVBQUUsQ0FBQ2M7QUFGSSxLQW5EVDtBQXdEUk8sSUFBQUEsV0FBVyxFQUFFO0FBQ1QsaUJBQVMsSUFEQTtBQUVUaEIsTUFBQUEsSUFBSSxFQUFFTCxFQUFFLENBQUNVO0FBRkEsS0F4REw7QUE2RFJZLElBQUFBLElBQUksRUFBRTtBQUNGLGlCQUFTLElBRFA7QUFFRmpCLE1BQUFBLElBQUksRUFBRUwsRUFBRSxDQUFDTTtBQUZQLEtBN0RFO0FBaUVSaUIsSUFBQUEsS0FBSyxFQUFFO0FBQ0gsaUJBQVMsSUFETjtBQUVIbEIsTUFBQUEsSUFBSSxFQUFFTCxFQUFFLENBQUN3QjtBQUZOLEtBakVDO0FBcUVSQyxJQUFBQSxNQUFNLEVBQUU7QUFDSixpQkFBUyxJQURMO0FBRUpwQixNQUFBQSxJQUFJLEVBQUVMLEVBQUUsQ0FBQ3dCO0FBRkwsS0FyRUE7QUF5RVJFLElBQUFBLE9BQU8sRUFBRTtBQUNMLGlCQUFTLElBREo7QUFFTHJCLE1BQUFBLElBQUksRUFBRUwsRUFBRSxDQUFDd0I7QUFGSixLQXpFRDtBQThFUkcsSUFBQUEsT0FBTyxFQUFFO0FBQ0wsaUJBQVMsSUFESjtBQUVMdEIsTUFBQUEsSUFBSSxFQUFFTCxFQUFFLENBQUNRO0FBRkosS0E5RUQ7QUFvRlJvQixJQUFBQSxJQUFJLEVBQUU7QUFwRkUsR0FIUDtBQTJGTEMsRUFBQUEsTUFBTSxFQUFFLGtCQUFXO0FBQ2Y7QUFDQSxTQUFLQyxTQUFMLEdBQWlCLEtBQWpCO0FBQ0EsU0FBS0MsV0FBTCxHQUFtQixDQUFuQjtBQUNBLFNBQUtDLFVBQUwsR0FBa0IsS0FBbEI7QUFDQSxTQUFLQyxNQUFMLEdBQWMsS0FBZDtBQUNBLFNBQUtDLEtBQUwsR0FBYSxFQUFiO0FBQ0EsU0FBS0MsS0FBTCxHQUFhLENBQWI7QUFDQSxTQUFLQyxRQUFMLEdBQWdCLENBQWhCO0FBQ0EsU0FBS0MsVUFBTCxHQUFrQixDQUFsQjtBQUNBLFNBQUtDLFVBQUwsR0FBa0IsQ0FBbEI7QUFDQSxTQUFLQyxlQUFMLEdBQXVCLENBQXZCO0FBQ0EsU0FBS1osT0FBTCxDQUFhYSxNQUFiLEdBQXNCLEtBQXRCO0FBQ0EsU0FBS0MsSUFBTCxDQUFVQyxFQUFWLENBQWEsVUFBYixFQUF5QixVQUFTQyxLQUFULEVBQWdCO0FBQ3JDLFVBQUksS0FBS2YsSUFBTCxJQUFhLENBQUMsS0FBS0ssTUFBbkIsSUFBNkIsS0FBS0QsVUFBdEMsRUFBa0Q7QUFDOUMsYUFBS1ksYUFBTDtBQUNIO0FBQ0osS0FKd0IsQ0FJdkJDLElBSnVCLENBSWxCLElBSmtCLENBQXpCO0FBS0EsU0FBS0osSUFBTCxDQUFVQyxFQUFWLENBQWEsV0FBYixFQUEwQixVQUFTQyxLQUFULEVBQWdCO0FBQ3RDLFVBQUksS0FBS2YsSUFBTCxJQUFhLENBQUMsS0FBS0ssTUFBbkIsSUFBNkIsS0FBS0QsVUFBdEMsRUFBa0Q7QUFDOUMsYUFBS1ksYUFBTDtBQUNIO0FBQ0osS0FKeUIsQ0FJeEJDLElBSndCLENBSW5CLElBSm1CLENBQTFCO0FBS0gsR0FsSEk7QUFtSEw7QUFDQUMsRUFBQUEsS0FwSEssbUJBb0hHLENBRVAsQ0F0SEk7QUF3SExGLEVBQUFBLGFBQWEsRUFBRSx5QkFBVztBQUN0QjtBQUNBLFFBQUlHLFFBQVEsR0FBRy9DLEVBQUUsQ0FBQ2dELFdBQUgsQ0FBZSxLQUFLbkMsV0FBcEIsQ0FBZjtBQUNBLFNBQUs0QixJQUFMLENBQVVRLFFBQVYsQ0FBbUJGLFFBQW5CO0FBQ0FBLElBQUFBLFFBQVEsQ0FBQ0csWUFBVCxDQUFzQixhQUF0QixFQUFxQ0MsUUFBckMsQ0FBOEMsS0FBS2xDLFNBQW5ELEVBQThELEtBQUt3QixJQUFuRTtBQUNBTSxJQUFBQSxRQUFRLENBQUNHLFlBQVQsQ0FBc0IsYUFBdEIsRUFBcUNFLFlBQXJDLENBQWtELEtBQUtyQyxTQUFMLENBQWVtQyxZQUFmLENBQTRCLGlCQUE1QixFQUErQ0csRUFBakc7QUFDQSxTQUFLcEMsU0FBTCxHQUFpQjhCLFFBQWpCO0FBQ0FBLElBQUFBLFFBQVEsQ0FBQ08sV0FBVCxDQUFxQixLQUFLdkMsU0FBTCxDQUFld0MscUJBQWYsQ0FBcUN2RCxFQUFFLENBQUN3RCxFQUFILENBQU0sQ0FBQyxHQUFELEdBQU8sT0FBT0MsSUFBSSxDQUFDQyxHQUFMLENBQVMsS0FBS2pCLElBQUwsQ0FBVWtCLEtBQVYsR0FBa0JGLElBQUksQ0FBQ0csRUFBdkIsR0FBNEIsR0FBckMsQ0FBcEIsRUFBK0QsSUFBL0QsQ0FBckMsQ0FBckI7QUFDQSxTQUFLQyxhQUFMO0FBRUgsR0FsSUk7QUFvSUxBLEVBQUFBLGFBQWEsRUFBRSx5QkFBVztBQUN0QixTQUFLakMsSUFBTCxHQUFZLEtBQVo7QUFDQSxRQUFJa0MsSUFBSSxHQUFHLElBQVg7QUFDQUMsSUFBQUEsT0FBTyxDQUFDQyxLQUFSLENBQWMsR0FBZDtBQUNBLFNBQUtDLFlBQUwsQ0FBa0IsWUFBVztBQUN6QixVQUFJQyxNQUFNLEdBQUdsRSxFQUFFLENBQUNnRCxXQUFILENBQWVjLElBQUksQ0FBQzVDLGNBQXBCLENBQWI7QUFDQSxXQUFLaUQsT0FBTCxHQUFlbkUsRUFBRSxDQUFDb0UsV0FBSCxDQUFlQyxJQUFmLENBQW9CLEtBQUs1QyxNQUF6QixFQUFpQyxLQUFqQyxFQUF3QyxHQUF4QyxDQUFmLENBRnlCLENBRW9DOztBQUM3RHFDLE1BQUFBLElBQUksQ0FBQ3JCLElBQUwsQ0FBVVEsUUFBVixDQUFtQmlCLE1BQW5CO0FBQ0FBLE1BQUFBLE1BQU0sQ0FBQ1osV0FBUCxDQUFtQnRELEVBQUUsQ0FBQ3dELEVBQUgsQ0FBTSxDQUFOLEVBQVMsSUFBVCxFQUFlLENBQWYsQ0FBbkI7QUFDQSxVQUFJYyxPQUFPLEdBQUd0RSxFQUFFLENBQUNnRCxXQUFILENBQWVjLElBQUksQ0FBQzNDLGVBQXBCLENBQWQ7QUFDQTJDLE1BQUFBLElBQUksQ0FBQ3JCLElBQUwsQ0FBVVEsUUFBVixDQUFtQnFCLE9BQW5CO0FBQ0FBLE1BQUFBLE9BQU8sQ0FBQ2hCLFdBQVIsQ0FBb0J0RCxFQUFFLENBQUN3RCxFQUFILENBQU0sQ0FBTixFQUFTLElBQVQsRUFBZSxDQUFmLENBQXBCO0FBQ0FPLE1BQUFBLE9BQU8sQ0FBQ0MsS0FBUixDQUFjLFdBQWQ7QUFDSCxLQVRELEVBU0csR0FUSDtBQVdBLFNBQUt6RCxVQUFMLENBQWdCMkMsWUFBaEIsQ0FBNkIsWUFBN0IsRUFBMkNlLFlBQTNDLENBQXdELFlBQVc7QUFDL0QsV0FBS00sU0FBTDtBQUNBVCxNQUFBQSxJQUFJLENBQUNVLGVBQUw7O0FBQ0EsVUFBSVYsSUFBSSxDQUFDaEMsU0FBVCxFQUFvQjtBQUNoQmdDLFFBQUFBLElBQUksQ0FBQ1csV0FBTDtBQUNBVixRQUFBQSxPQUFPLENBQUNDLEtBQVIsQ0FBYyxTQUFkO0FBQ0EsWUFBSVUsT0FBTyxHQUFHMUUsRUFBRSxDQUFDZ0QsV0FBSCxDQUFlYyxJQUFJLENBQUMxQyxlQUFwQixDQUFkO0FBQ0EwQyxRQUFBQSxJQUFJLENBQUNyQixJQUFMLENBQVVRLFFBQVYsQ0FBbUJ5QixPQUFuQjtBQUNBQSxRQUFBQSxPQUFPLENBQUNwQixXQUFSLENBQW9CdEQsRUFBRSxDQUFDd0QsRUFBSCxDQUFNLENBQU4sRUFBUyxJQUFULEVBQWUsQ0FBZixDQUFwQjtBQUNBTyxRQUFBQSxPQUFPLENBQUNDLEtBQVIsQ0FBYyxRQUFkLEVBTmdCLENBU2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0g7O0FBQ0RGLE1BQUFBLElBQUksQ0FBQ2hDLFNBQUwsR0FBaUIsS0FBakI7QUFFSCxLQW5CRCxFQW1CRyxHQW5CSCxFQWZzQixDQW1DdEI7O0FBRUEsU0FBS21DLFlBQUwsQ0FBa0IsWUFBVztBQUN6QixVQUFJSCxJQUFJLENBQUNoQyxTQUFULEVBQW9CO0FBQ2hCLGFBQUs2QyxRQUFMLEdBQWdCM0UsRUFBRSxDQUFDb0UsV0FBSCxDQUFlQyxJQUFmLENBQW9CLEtBQUszQyxPQUF6QixFQUFrQyxLQUFsQyxFQUF5QyxHQUF6QyxDQUFoQixDQURnQixDQUMrQzs7QUFDL0QsYUFBS0MsT0FBTCxDQUFhYSxNQUFiLEdBQXNCLEtBQXRCO0FBQ0g7QUFDSixLQUxELEVBS0csR0FMSDtBQVFBLFNBQUt2QixTQUFMLENBQWVpQyxZQUFmLENBQTRCLGFBQTVCLEVBQTJDZSxZQUEzQyxDQUF3RCxZQUFXO0FBQy9ELFdBQUtXLFdBQUw7QUFDSCxLQUZELEVBRUcsR0FGSDtBQUdBLFNBQUs3RCxTQUFMLENBQWVtQyxZQUFmLENBQTRCLGlCQUE1QixFQUErQzJCLGFBQS9DLENBQTZELENBQTdEO0FBQ0EsU0FBSzlELFNBQUwsQ0FBZW1DLFlBQWYsQ0FBNEIsaUJBQTVCLEVBQStDZSxZQUEvQyxDQUE0RCxZQUFXO0FBQ25FO0FBQ0EsV0FBS1ksYUFBTCxDQUFtQixDQUFuQjs7QUFDQSxVQUFJLENBQUNmLElBQUksQ0FBQzdCLE1BQVYsRUFBa0I7QUFDZDZCLFFBQUFBLElBQUksQ0FBQ2xDLElBQUwsR0FBWSxJQUFaO0FBQ0FrQyxRQUFBQSxJQUFJLENBQUNXLFdBQUw7QUFDSDtBQUNKLEtBUEQsRUFPRyxHQVBIO0FBUUgsR0E3TEk7QUErTExELEVBQUFBLGVBQWUsRUFBRSwyQkFBVztBQUN4QixRQUFJLEtBQUtyQyxLQUFMLElBQWMsRUFBbEIsRUFBc0I7QUFDbEIsV0FBS25CLElBQUwsQ0FBVWtDLFlBQVYsQ0FBdUIsZ0JBQXZCLEVBQXlDNEIsV0FBekMsQ0FBcUQsS0FBSzNDLEtBQUwsR0FBYSxFQUFiLEdBQWtCLEdBQXZFO0FBQ0EsV0FBS3BCLFNBQUwsQ0FBZW1DLFlBQWYsQ0FBNEIsZ0JBQTVCLEVBQThDNEIsV0FBOUMsQ0FBMEQsS0FBSzNDLEtBQUwsR0FBYSxFQUFiLEdBQWtCLEdBQTVFO0FBQ0g7QUFDSixHQXBNSTtBQXVNTDRDLEVBQUFBLFdBQVcsRUFBRSx1QkFBVztBQUVwQixTQUFLcEQsT0FBTCxDQUFhYSxNQUFiLEdBQXNCLElBQXRCO0FBQ0EsU0FBS1YsU0FBTCxHQUFpQixJQUFqQjtBQUNILEdBM01JO0FBOE1MMkMsRUFBQUEsV0FBVyxFQUFFLHVCQUFXO0FBQ3BCLFNBQUt0QyxLQUFMO0FBQ0EsU0FBSy9CLFlBQUwsQ0FBa0I0RSxNQUFsQixHQUEyQixZQUFZLEtBQUs3QyxLQUE1QztBQUNILEdBak5JO0FBbU5MOEMsRUFBQUEsUUFBUSxFQUFFLG9CQUFXO0FBQ2pCLFFBQUksQ0FBQyxLQUFLaEQsTUFBVixFQUFrQjtBQUNkLFdBQUtBLE1BQUwsR0FBYyxJQUFkO0FBQ0g7O0FBQ0QsUUFBSSxLQUFLRixXQUFMLElBQW9CLENBQXhCLEVBQTJCO0FBQ3ZCLFdBQUtrQyxZQUFMLENBQWtCLFlBQVc7QUFDekIsYUFBS3hELGFBQUwsQ0FBbUJnQyxJQUFuQixDQUF3QkQsTUFBeEIsR0FBaUMsSUFBakM7QUFDQSxhQUFLNUIsYUFBTCxDQUFtQm9FLE1BQW5CLEdBQTRCLEtBQUs3QyxLQUFqQztBQUNBLGFBQUt2QixhQUFMLENBQW1CNkIsSUFBbkIsQ0FBd0JELE1BQXhCLEdBQWlDLElBQWpDO0FBQ0F1QixRQUFBQSxPQUFPLENBQUNDLEtBQVIsQ0FBYyxXQUFkO0FBQ0gsT0FMRCxFQUtHLEdBTEg7QUFNSDs7QUFDRCxRQUFJLEtBQUtqQyxXQUFMLElBQW9CLENBQXhCLEVBQTJCO0FBQ3ZCLFdBQUtrQyxZQUFMLENBQWtCLFlBQVc7QUFDekIsYUFBS3RELG9CQUFMLENBQTBCOEIsSUFBMUIsQ0FBK0JELE1BQS9CLEdBQXdDLElBQXhDO0FBQ0EsYUFBSzVCLGFBQUwsQ0FBbUJvRSxNQUFuQixHQUE0QixLQUFLN0MsS0FBakM7QUFDQSxhQUFLdkIsYUFBTCxDQUFtQjZCLElBQW5CLENBQXdCRCxNQUF4QixHQUFpQyxJQUFqQztBQUNBdUIsUUFBQUEsT0FBTyxDQUFDQyxLQUFSLENBQWMsWUFBZDtBQUNILE9BTEQsRUFLRyxHQUxIO0FBTUg7QUFDSixHQXZPSTtBQXlPTGtCLEVBQUFBLFFBQVEsRUFBRSxrQkFBU0MsQ0FBVCxFQUFZO0FBQ2xCLFFBQUksQ0FBQyxLQUFLbEQsTUFBVixFQUFrQjtBQUNkLFdBQUtHLFFBQUwsR0FBZ0IrQyxDQUFoQixDQURjLENBRWQ7O0FBQ0EsV0FBS0YsUUFBTDtBQUNIO0FBQ0osR0EvT0k7QUFpUExHLEVBQUFBLFFBQVEsRUFBRSxvQkFBVztBQUNqQixTQUFLL0QsV0FBTCxDQUFpQm9CLElBQWpCLENBQXNCRCxNQUF0QixHQUErQixJQUEvQjtBQUVILEdBcFBJO0FBc1BMNkMsRUFBQUEsU0FBUyxFQUFFLHFCQUFXO0FBQ2xCLFNBQUtoRSxXQUFMLENBQWlCb0IsSUFBakIsQ0FBc0JELE1BQXRCLEdBQStCLEtBQS9CO0FBQ0EsU0FBS1IsVUFBTCxHQUFrQixJQUFsQixDQUZrQixDQUdsQjtBQUNILEdBMVBJO0FBNFBMc0QsRUFBQUEsU0FBUyxFQUFFLHFCQUFXO0FBQ2xCLFNBQUtELFNBQUw7QUFDQSxTQUFLL0QsSUFBTCxDQUFVMEQsTUFBVixHQUFtQixFQUFuQixDQUZrQixDQUdsQjtBQUNILEdBaFFJO0FBa1FMTyxFQUFBQSxTQUFTLEVBQUUscUJBQVc7QUFDbEIsU0FBS3hELFdBQUwsR0FBbUIsQ0FBbkI7QUFDQSxTQUFLeUQsTUFBTCxHQUFjLEtBQWQ7QUFDQSxTQUFLSCxTQUFMO0FBQ0EsU0FBS0ksT0FBTDtBQUNILEdBdlFJO0FBeVFMQSxFQUFBQSxPQUFPLEVBQUUsbUJBQVc7QUFDaEI7QUFDQSxTQUFLQyxRQUFMLENBQWMsWUFBVztBQUNyQixXQUFLQyxTQUFMO0FBQ0gsS0FGRCxFQUVHLENBRkgsRUFGZ0IsQ0FLaEI7QUFDSCxHQS9RSTtBQWlSTEEsRUFBQUEsU0FBUyxFQUFFLHFCQUFXO0FBQ2xCLFFBQUksS0FBS3pELEtBQUwsSUFBYyxDQUFsQixFQUFxQjtBQUNqQixXQUFLQSxLQUFMLEdBQWEsS0FBS0EsS0FBTCxHQUFhLENBQTFCO0FBQ0EsV0FBS1osSUFBTCxDQUFVMEQsTUFBVixHQUFtQixLQUFLOUMsS0FBTCxHQUFhLEdBQWhDO0FBQ0FsQyxNQUFBQSxFQUFFLENBQUM0RixHQUFILENBQU8sZUFBZSxLQUFLMUQsS0FBM0I7QUFDSCxLQUpELE1BSU87QUFDSCxXQUFLSCxXQUFMLEdBQW1CLENBQW5CO0FBQ0EsV0FBS2tELFFBQUw7QUFDSDtBQUNKLEdBMVJJO0FBNFJMWSxFQUFBQSxNQUFNLEVBQUUsa0JBQVc7QUFDZixTQUFLakYsYUFBTCxDQUFtQjZCLElBQW5CLENBQXdCRCxNQUF4QixHQUFpQyxLQUFqQztBQUNBeEMsSUFBQUEsRUFBRSxDQUFDOEYsUUFBSCxDQUFZQyxTQUFaLENBQXNCLEdBQXRCO0FBQ0gsR0EvUkk7QUFpU0xDLEVBQUFBLE1BalNLLGtCQWlTRUMsRUFqU0YsRUFpU007QUFDUCxRQUFJLEtBQUs3RCxRQUFMLElBQWlCLENBQXJCLEVBQXdCO0FBQ3BCLFVBQUksS0FBS0ssSUFBTCxDQUFVa0IsS0FBVixHQUFrQixFQUF0QixFQUEwQjtBQUN0QixhQUFLdEIsVUFBTCxJQUFtQixLQUFLNEQsRUFBeEI7QUFDQSxhQUFLeEQsSUFBTCxDQUFVa0IsS0FBVixJQUFtQixLQUFLdEIsVUFBTCxHQUFrQjRELEVBQXJDO0FBQ0g7QUFDSixLQUxELE1BS08sSUFBSSxLQUFLN0QsUUFBTCxJQUFpQixDQUFDLENBQXRCLEVBQXlCO0FBQzVCLFVBQUksS0FBS0ssSUFBTCxDQUFVa0IsS0FBVixHQUFrQixDQUFDLEVBQXZCLEVBQTJCO0FBQ3ZCLGFBQUt0QixVQUFMLElBQW1CLEtBQUs0RCxFQUF4QjtBQUNBLGFBQUt4RCxJQUFMLENBQVVrQixLQUFWLElBQW1CLEtBQUt0QixVQUFMLEdBQWtCNEQsRUFBckM7QUFDSDtBQUNKLEtBTE0sTUFLQSxJQUFJLEtBQUs5RCxLQUFMLElBQWMsQ0FBZCxJQUFtQixLQUFLQSxLQUFMLElBQWMsRUFBckMsRUFBeUM7QUFDNUMsV0FBS0csVUFBTCxJQUFtQjJELEVBQW5CO0FBQ0EsV0FBSzFELGVBQUwsR0FBdUJrQixJQUFJLENBQUN5QyxHQUFMLENBQVMsS0FBSzVELFVBQWQsQ0FBdkI7QUFDQSxXQUFLRyxJQUFMLENBQVVrQixLQUFWLElBQW1CLEtBQUtwQixlQUFMLElBQXdCLEtBQUtKLEtBQUwsR0FBYSxDQUFyQyxJQUEwQzhELEVBQTdEO0FBQ0gsS0FKTSxNQUlBLElBQUksS0FBSzlELEtBQUwsSUFBYyxFQUFsQixFQUFzQjtBQUN6QixXQUFLRyxVQUFMLElBQW1CMkQsRUFBbkI7QUFDQSxXQUFLMUQsZUFBTCxHQUF1QmtCLElBQUksQ0FBQ3lDLEdBQUwsQ0FBUyxLQUFLNUQsVUFBZCxDQUF2QjtBQUNBLFdBQUtHLElBQUwsQ0FBVWtCLEtBQVYsSUFBbUIsS0FBS3BCLGVBQUwsR0FBdUIsQ0FBdkIsR0FBMkIwRCxFQUE5QztBQUNIO0FBQ0o7QUFyVEksQ0FBVCIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBzY29yZURpc3BsYXk6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuTGFiZWxcclxuICAgICAgICB9LFxyXG4gICAgICAgIGJhY2tncm91bmQ6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuTm9kZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ2FtZU92ZXJQYW5sZToge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgICAgICB0eXBlOiBjYy5MYXlvdXRcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdhbWVPdmVyUGFubGVfZmFpbGVkOiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLkxheW91dFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ2FtZU92ZXJTY29yZToge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgICAgICB0eXBlOiBjYy5MYWJlbFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZmxvb3JQcmVmYWI6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuUHJlZmFiXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgZmFrZWZsb29yOiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLk5vZGVcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICByb3BlOiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLk5vZGVcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBsYXN0Zmxvb3I6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuTm9kZVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHBhcnRpY2xlUHJlZmFiOiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLlByZWZhYlxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHBhcnRpY2xlUHJlZmFiMjoge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgICAgICB0eXBlOiBjYy5QcmVmYWJcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBwYXJ0aWNsZVByZWZhYjM6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuUHJlZmFiXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgbGF5b3V0U3RhcnQ6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuTGF5b3V0XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgdGltZToge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgICAgICB0eXBlOiBjYy5MYWJlbFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbXVzaWM6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuQXVkaW9DbGlwXHJcbiAgICAgICAgfSxcclxuICAgICAgICBlZmZlY3Q6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuQXVkaW9DbGlwXHJcbiAgICAgICAgfSxcclxuICAgICAgICBlZmZlY3QxOiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLkF1ZGlvQ2xpcFxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHBlcmZlY3Q6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuTm9kZVxyXG4gICAgICAgIH0sXHJcblxyXG5cclxuICAgICAgICBmbGFnOiB0cnVlLFxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAvLyB0aGlzLmNob2ljZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5pc1BlcmZlY3QgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmZsYWdfbnVtYmVyID0gMDtcclxuICAgICAgICB0aGlzLmZsYWdfc3RhcnQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmlzT3ZlciA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuY291bnQgPSA2MDtcclxuICAgICAgICB0aGlzLnNjb3JlID0gMDtcclxuICAgICAgICB0aGlzLmZhbGxzaWRlID0gMDtcclxuICAgICAgICB0aGlzLmFuZ2xlU3BlZWQgPSAwO1xyXG4gICAgICAgIHRoaXMuYW5nbGVUaW1lciA9IDA7XHJcbiAgICAgICAgdGhpcy5zaGFrZUFuZ2xlc3BlZWQgPSAwO1xyXG4gICAgICAgIHRoaXMucGVyZmVjdC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm5vZGUub24oJ3RvdWNoZW5kJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZmxhZyAmJiAhdGhpcy5pc092ZXIgJiYgdGhpcy5mbGFnX3N0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNwYXduTmV3Rmxvb3IoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKCdtb3VzZWRvd24nLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5mbGFnICYmICF0aGlzLmlzT3ZlciAmJiB0aGlzLmZsYWdfc3RhcnQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3Bhd25OZXdGbG9vcigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgIH0sXHJcbiAgICAvLyBMSUZFLUNZQ0xFIENBTExCQUNLUzpcclxuICAgIHN0YXJ0KCkge1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgc3Bhd25OZXdGbG9vcjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy8g5L2/55So57uZ5a6a55qE5qih5p2/5Zyo5Zy65pmv5Lit55Sf5oiQ5LiA5Liq5paw6IqC54K5XHJcbiAgICAgICAgdmFyIG5ld2Zsb29yID0gY2MuaW5zdGFudGlhdGUodGhpcy5mbG9vclByZWZhYik7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKG5ld2Zsb29yKTtcclxuICAgICAgICBuZXdmbG9vci5nZXRDb21wb25lbnQoJ2Zsb29yU2NyaXB0JykuYmluZG5vZGUodGhpcy5sYXN0Zmxvb3IsIHRoaXMubm9kZSk7XHJcbiAgICAgICAgbmV3Zmxvb3IuZ2V0Q29tcG9uZW50KCdmbG9vclNjcmlwdCcpLmNoYW5nZVNwcml0ZSh0aGlzLmZha2VmbG9vci5nZXRDb21wb25lbnQoJ2Zha2VmbG9vclNjcmlwdCcpLmlkKTtcclxuICAgICAgICB0aGlzLmxhc3RmbG9vciA9IG5ld2Zsb29yO1xyXG4gICAgICAgIG5ld2Zsb29yLnNldFBvc2l0aW9uKHRoaXMuZmFrZWZsb29yLmNvbnZlcnRUb1dvcmxkU3BhY2VBUihjYy52MigtNjMwICsgMzMwMCAqIE1hdGguc2luKHRoaXMubm9kZS5hbmdsZSAqIE1hdGguUEkgLyAxODApLCAxODQwKSkpO1xyXG4gICAgICAgIHRoaXMuaGlkZUZha2VGbG9vcigpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgaGlkZUZha2VGbG9vcjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5mbGFnID0gZmFsc2U7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGNvbnNvbGUuZGVidWcoXCIwXCIpO1xyXG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgbmV3UGFyID0gY2MuaW5zdGFudGlhdGUoc2VsZi5wYXJ0aWNsZVByZWZhYik7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudCA9IGNjLmF1ZGlvRW5naW5lLnBsYXkodGhpcy5lZmZlY3QsIGZhbHNlLCAwLjMpOyAvL1xyXG4gICAgICAgICAgICBzZWxmLm5vZGUuYWRkQ2hpbGQobmV3UGFyKTtcclxuICAgICAgICAgICAgbmV3UGFyLnNldFBvc2l0aW9uKGNjLnYyKDAsIDI1OTAsIDApKTtcclxuICAgICAgICAgICAgdmFyIG5ld1BhcjIgPSBjYy5pbnN0YW50aWF0ZShzZWxmLnBhcnRpY2xlUHJlZmFiMik7XHJcbiAgICAgICAgICAgIHNlbGYubm9kZS5hZGRDaGlsZChuZXdQYXIyKTtcclxuICAgICAgICAgICAgbmV3UGFyMi5zZXRQb3NpdGlvbihjYy52MigwLCAyNTkwLCAwKSk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoJ3BhcnRpY2xlcycpO1xyXG4gICAgICAgIH0sIDAuNClcclxuXHJcbiAgICAgICAgdGhpcy5iYWNrZ3JvdW5kLmdldENvbXBvbmVudCgnQmFja0NoYW5nZScpLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5zdGFydGRvd24oKTtcclxuICAgICAgICAgICAgc2VsZi5jaGFuZ2VXYXZlU3BlZWQoKTtcclxuICAgICAgICAgICAgaWYgKHNlbGYuaXNQZXJmZWN0KSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmNoYW5nZVNjb3JlKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKFwicGVyZmVjdFwiKTtcclxuICAgICAgICAgICAgICAgIHZhciBuZXdQYXIzID0gY2MuaW5zdGFudGlhdGUoc2VsZi5wYXJ0aWNsZVByZWZhYjMpO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5ub2RlLmFkZENoaWxkKG5ld1BhcjMpO1xyXG4gICAgICAgICAgICAgICAgbmV3UGFyMy5zZXRQb3NpdGlvbihjYy52MigwLCAzMzAwLCAwKSk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdmbG93ZXInKTtcclxuXHJcblxyXG4gICAgICAgICAgICAgICAgLy90aGlzLmdldENvbXBvbmVudCgnR3JlYXRXb3JrJykuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmRlYnVnKFwiY3JlYXRlIHBhcnRpY2xlXCIpO1xyXG4gICAgICAgICAgICAgICAgLy90aGlzLmNyZWF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgLy99LCAwLjQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2VsZi5pc1BlcmZlY3QgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgfSwgMC43KTtcclxuICAgICAgICAvL2NvbnNvbGUuZGVidWcoXCIxXCIpO1xyXG5cclxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKHNlbGYuaXNQZXJmZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnQxID0gY2MuYXVkaW9FbmdpbmUucGxheSh0aGlzLmVmZmVjdDEsIGZhbHNlLCAwLjUpOyAvL+esrOS6jOS4qumfs+aViFxyXG4gICAgICAgICAgICAgICAgdGhpcy5wZXJmZWN0LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgMC43KVxyXG5cclxuXHJcbiAgICAgICAgdGhpcy5sYXN0Zmxvb3IuZ2V0Q29tcG9uZW50KCdmbG9vclNjcmlwdCcpLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VTdGF0ZSgpO1xyXG4gICAgICAgIH0sIDAuNyk7XHJcbiAgICAgICAgdGhpcy5mYWtlZmxvb3IuZ2V0Q29tcG9uZW50KCdmYWtlZmxvb3JTY3JpcHQnKS5jaGFuZ2VUZXh0dXJlKDEpO1xyXG4gICAgICAgIHRoaXMuZmFrZWZsb29yLmdldENvbXBvbmVudCgnZmFrZWZsb29yU2NyaXB0Jykuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvLyDov5nph4znmoQgdGhpcyDmjIflkJEgY29tcG9uZW50XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlVGV4dHVyZSgyKTtcclxuICAgICAgICAgICAgaWYgKCFzZWxmLmlzT3Zlcikge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5mbGFnID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHNlbGYuY2hhbmdlU2NvcmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIDAuNyk7XHJcbiAgICB9LFxyXG5cclxuICAgIGNoYW5nZVdhdmVTcGVlZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuc2NvcmUgPD0gNTApIHtcclxuICAgICAgICAgICAgdGhpcy5yb3BlLmdldENvbXBvbmVudCgncGVuZHVsdW1TY3JpcHQnKS5jaGFuZ2VTcGVlZCh0aGlzLnNjb3JlIC8gMjAgKyAxLjUpO1xyXG4gICAgICAgICAgICB0aGlzLmZha2VmbG9vci5nZXRDb21wb25lbnQoJ3BlbmR1bHVtU2NyaXB0JykuY2hhbmdlU3BlZWQodGhpcy5zY29yZSAvIDIwICsgMS41KTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuXHJcbiAgICBWZXJ5UGVyZmVjdDogZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgIHRoaXMucGVyZmVjdC5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuaXNQZXJmZWN0ID0gdHJ1ZTtcclxuICAgIH0sXHJcblxyXG5cclxuICAgIGNoYW5nZVNjb3JlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLnNjb3JlKys7XHJcbiAgICAgICAgdGhpcy5zY29yZURpc3BsYXkuc3RyaW5nID0gJ1Njb3JlOiAnICsgdGhpcy5zY29yZTtcclxuICAgIH0sXHJcblxyXG4gICAgZ2FtZU92ZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5pc092ZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5pc092ZXIgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5mbGFnX251bWJlciA9PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nYW1lT3ZlclBhbmxlLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZU92ZXJTY29yZS5zdHJpbmcgPSB0aGlzLnNjb3JlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nYW1lT3ZlclNjb3JlLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoXCJwYW5lbF9lbmRcIik7XHJcbiAgICAgICAgICAgIH0sIDEuNSlcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuZmxhZ19udW1iZXIgPT0gMSkge1xyXG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZU92ZXJQYW5sZV9mYWlsZWQubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nYW1lT3ZlclNjb3JlLnN0cmluZyA9IHRoaXMuc2NvcmU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWVPdmVyU2NvcmUubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5kZWJ1ZyhcInBhbmVsX2ZhaWxcIik7XHJcbiAgICAgICAgICAgIH0sIDEuNSlcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIGZhbGxkb3duOiBmdW5jdGlvbihpKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzT3Zlcikge1xyXG4gICAgICAgICAgICB0aGlzLmZhbGxzaWRlID0gaTtcclxuICAgICAgICAgICAgLy8gdGhpcy5jaG9pY2UgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5nYW1lT3ZlcigpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgTGF5b3V0T246IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMubGF5b3V0U3RhcnQubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgTGF5b3V0T2ZmOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLmxheW91dFN0YXJ0Lm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5mbGFnX3N0YXJ0ID0gdHJ1ZTtcclxuICAgICAgICAvLyBjb25zb2xlLmRlYnVnKFwiY2xvc2VcIik7XHJcbiAgICB9LFxyXG5cclxuICAgIGJ1dHRvbk9uZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5MYXlvdXRPZmYoKTtcclxuICAgICAgICB0aGlzLnRpbWUuc3RyaW5nID0gJyc7XHJcbiAgICAgICAgLy8gY29uc29sZS5kZWJ1ZygnYnV0dG9uIG9uZScpXHJcbiAgICB9LFxyXG5cclxuICAgIGJ1dHRvblR3bzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5mbGFnX251bWJlciA9IDE7XHJcbiAgICAgICAgdGhpcy5jaG9pY2UgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLkxheW91dE9mZigpO1xyXG4gICAgICAgIHRoaXMuaW5pVGltZSgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBpbmlUaW1lOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAvLyBpZiAodGhpcy5jb3VudCA+PSAwKSB7XHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5jb3VudGRvd24oKTtcclxuICAgICAgICB9LCAxKTtcclxuICAgICAgICAvLyB9XHJcbiAgICB9LFxyXG5cclxuICAgIGNvdW50ZG93bjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY291bnQgPj0gMSkge1xyXG4gICAgICAgICAgICB0aGlzLmNvdW50ID0gdGhpcy5jb3VudCAtIDE7XHJcbiAgICAgICAgICAgIHRoaXMudGltZS5zdHJpbmcgPSB0aGlzLmNvdW50ICsgJ3MnO1xyXG4gICAgICAgICAgICBjYy5sb2coXCJjb3VudGRvd246XCIgKyB0aGlzLmNvdW50KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmZsYWdfbnVtYmVyID0gMDtcclxuICAgICAgICAgICAgdGhpcy5nYW1lT3ZlcigpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgcmVzdGFyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLmdhbWVPdmVyU2NvcmUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJzEnKTtcclxuICAgIH0sXHJcblxyXG4gICAgdXBkYXRlKGR0KSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZmFsbHNpZGUgPT0gMSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5ub2RlLmFuZ2xlIDwgOTApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYW5nbGVTcGVlZCArPSA1MCAqIGR0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlLmFuZ2xlICs9IHRoaXMuYW5nbGVTcGVlZCAqIGR0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmZhbGxzaWRlID09IC0xKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm5vZGUuYW5nbGUgPiAtOTApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYW5nbGVTcGVlZCArPSA1MCAqIGR0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlLmFuZ2xlIC09IHRoaXMuYW5nbGVTcGVlZCAqIGR0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnNjb3JlID49IDUgJiYgdGhpcy5zY29yZSA8PSAzNSkge1xyXG4gICAgICAgICAgICB0aGlzLmFuZ2xlVGltZXIgKz0gZHQ7XHJcbiAgICAgICAgICAgIHRoaXMuc2hha2VBbmdsZXNwZWVkID0gTWF0aC5jb3ModGhpcy5hbmdsZVRpbWVyKTtcclxuICAgICAgICAgICAgdGhpcy5ub2RlLmFuZ2xlICs9IHRoaXMuc2hha2VBbmdsZXNwZWVkICogKHRoaXMuc2NvcmUgLyA1KSAqIGR0O1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5zY29yZSA+PSAzNSkge1xyXG4gICAgICAgICAgICB0aGlzLmFuZ2xlVGltZXIgKz0gZHQ7XHJcbiAgICAgICAgICAgIHRoaXMuc2hha2VBbmdsZXNwZWVkID0gTWF0aC5jb3ModGhpcy5hbmdsZVRpbWVyKTtcclxuICAgICAgICAgICAgdGhpcy5ub2RlLmFuZ2xlICs9IHRoaXMuc2hha2VBbmdsZXNwZWVkICogNSAqIGR0O1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbn0pOyJdfQ==