{"version":3,"sources":["assets\\scripts\\BackChange.js"],"names":["cc","Class","Component","properties","SpriteFrame1","type","SpriteFrame","SpriteFrame2","SpriteFrame3","CycleFrame","back","Prefab","width","height","offset","movespeed","rate","downtime","time","begincycle","alloffset","start","console","debug","hblew","createSprite","curcyc","instantiate","node","addChild","size","getOriginalSize","setPosition","sprite","getComponent","Sprite","spriteFrame","sf","cur","zindex","curspr","movedown","y","children","changeframe","lower","heigher","startdown","update","dt","eventTrigger"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        SpriteFrame1: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n        SpriteFrame2:{\r\n            default:null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n        SpriteFrame3:{\r\n            default:null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n\r\n        CycleFrame: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n        back: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n        width: 0,\r\n        height: 0,\r\n        offset: 0,\r\n        movespeed: 0,\r\n        rate: 0,\r\n        downtime: 0,\r\n        time: 0,\r\n        begincycle: false,\r\n        alloffset:0,\r\n    },\r\n   \r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n\r\n    start() { //初始化图片\r\n        console.debug(this.alloffset);\r\n     \r\n        let hblew = 0;\r\n        this.createSprite(this.SpriteFrame1,hblew);\r\n        hblew+=this.width*this.rate;\r\n        this.createSprite(this.SpriteFrame2,hblew);\r\n        hblew+=this.width*this.rate;\r\n        this.createSprite(this.SpriteFrame3,hblew);\r\n        hblew+=this.width*this.rate;\r\n        \r\n        var curcyc = cc.instantiate(this.back);\r\n        this.node.addChild(curcyc);\r\n        let size = this.CycleFrame.getOriginalSize();\r\n        this.rate = size.height / size.width;\r\n        curcyc.setPosition(this.width / 2, hblew+ this.width * this.rate / 2);\r\n        curcyc.width = this.width;\r\n        curcyc.height = this.width * this.rate;\r\n        let sprite = curcyc.getComponent(cc.Sprite);\r\n        sprite.spriteFrame = this.CycleFrame;\r\n\r\n    },\r\n\r\n    createSprite:function(sf,hblew){\r\n        var cur = cc.instantiate(this.back);\r\n        let size = sf.getOriginalSize();\r\n        this.rate = size.height / size.width;\r\n        console.debug(this.rate);\r\n        this.zindex = -1000;\r\n        //cur.setLocalZOrder(-1);\r\n        this.node.addChild(cur);\r\n        let curspr = cur.getComponent(cc.Sprite);\r\n        curspr.spriteFrame = sf;\r\n        cur.width = this.width;\r\n        //this.height = this.width*this.rate;\r\n        cur.height = this.width * this.rate;\r\n        cur.setPosition(cur.width / 2, hblew+cur.height / 2);\r\n    },\r\n\r\n    movedown: function() {\r\n        this.node.y -= this.movespeed;\r\n        this.offset += this.movespeed;\r\n        this.alloffset +=this.movespeed;\r\n        //console.debug(this.node.children[0].height+this.node.children[1].height);\r\n        //console.debug(this.offset);\r\n        if (this.begincycle == false) { //判断是否该加载图片\r\n            if (this.offset + this.height + 600 >= this.node.children[0].height + this.node.children[1].height) { //600为预加载\r\n                this.changeframe();\r\n            }\r\n        } else {\r\n            let lower;\r\n            let heigher;\r\n            if (this.node.children[0].y < this.node.children[1].y) {\r\n                lower = this.node.children[0];\r\n                heigher = this.node.children[1];\r\n                //console.debug(\"1\");\r\n            } else {\r\n                lower = this.node.children[1];\r\n                heigher = this.node.children[0];\r\n                //console.debug(\"2\");\r\n            }\r\n            if (this.offset + 600 >= heigher.height) { //600为预加载\r\n                this.changeframe();\r\n            }\r\n        }\r\n\r\n    },\r\n    startdown: function() { //开始下移外部调用\r\n        this.time = 0;\r\n    },\r\n    update(dt) {\r\n        if (this.time < this.downtime) {\r\n            this.movedown();\r\n            this.time += dt;\r\n        }\r\n        this.getComponent('midwayEvent').eventTrigger(this.alloffset,this.offset);\r\n       // console.debug(this.alloffset);\r\n\r\n    },\r\n    changeframe: function() { //切换图片\r\n            let lower;\r\n            let heigher;\r\n            if (this.node.children[0].y < this.node.children[1].y) {\r\n                lower = this.node.children[0];\r\n                heigher = this.node.children[1];\r\n                console.debug(\"1\");\r\n            } else {\r\n                lower = this.node.children[1];\r\n                heigher = this.node.children[0];\r\n                console.debug(\"2\");\r\n            }\r\n            console.debug(\"change\");\r\n            let size = this.CycleFrame.getOriginalSize();\r\n            this.rate = size.height / size.width;\r\n\r\n            //let cur = this.node.children[0];\r\n            //console.debug(lower.y);\r\n            //console.debug(heigher.y);\r\n            lower.y += heigher.height + lower.height;\r\n            lower.y -= this.offset;\r\n            heigher.y -= this.offset;\r\n            //console.debug(lower.y);\r\n            //console.debug(heigher.y);\r\n            let sprite = lower.getComponent(cc.Sprite);\r\n            sprite.width = this.width;\r\n            sprite.height = this.width * this.rate;\r\n            this.node.setPosition(-630, -1170);\r\n            this.offset = 0;\r\n            console.debug(this.offset);\r\n            sprite.spriteFrame = this.CycleFrame;\r\n            this.begincycle = true;\r\n        }\r\n        // update (dt) {},\r\n});"]}