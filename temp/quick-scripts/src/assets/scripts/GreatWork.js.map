{"version":3,"sources":["assets\\scripts\\GreatWork.js"],"names":["cc","Class","Component","properties","Particle","type","Prefab","target","Node","speed","deviation","num","mula","length","first","phy","px","py","vx","vy","ax","ay","particle","next","move","x","y","changespeed","targetx","targety","dx","dy","init","midx","console","debug","Math","random","start","createOne","newpar","create","i","instantiate","scheduleOnce","setPosition","v2","node","addChild","update","dt","poi"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        Particle: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n        target: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        speed: 0,\r\n        deviation: 0,\r\n        num: 0,\r\n        mula: 0,\r\n        length: 0,\r\n        first: null,\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n    phy: function() {\r\n\r\n        this.px = 0;\r\n        this.py = 0;\r\n        this.vx = 0;\r\n        this.vy = 0;\r\n        this.ax = 0;\r\n        this.ay = 0;\r\n        this.particle = null;\r\n        this.next = null;\r\n        this.move = function() {\r\n            this.px += this.vx;\r\n            this.py += this.vy;\r\n\r\n            this.particle.x = this.px;\r\n            this.particle.y = this.py;\r\n        }\r\n        this.changespeed = function(target, mula) {\r\n            let targetx = target.x;\r\n            let targety = target.y;\r\n            //console.debug(targetx);\r\n            //console.debug(this.px);\r\n            //console.debug(targetx-this.px);\r\n\r\n            let dx = targetx - this.px;\r\n            let dy = targety - this.py;\r\n            //console.debug(dx*dx+dy*dy);\r\n            //console.debug(dx*dx/(dx*dx+dy*dy));\r\n            //console.debug(dx*dx/(dx*dx+dy*dy)*mula);\r\n            this.ax = dx * dx / (dx * dx + dy * dy) * mula;\r\n            this.ay = dy * dy / (dx * dx + dy * dy) * mula;\r\n            //console.debug(this.ax,this.ay);\r\n            this.vx += this.ax;\r\n            this.vy += this.ay;\r\n        }\r\n        this.init = function(particle, midx, speed) {\r\n            console.debug(\"init\");\r\n            this.particle = particle;\r\n            this.px = particle.x;\r\n            this.py = particle.y;\r\n            this.vx = (this.px - midx) * Math.random() * speed;\r\n            this.vy = this.vy * Math.random() * speed * (-1);\r\n        }\r\n\r\n    },\r\n    start() {\r\n        this.first = new this.phy(this.Particle);\r\n        console.debug(\"start\");\r\n    },\r\n\r\n    createOne: function(particle) {\r\n        console.debug(\"createOne\");\r\n        var newpar = new this.phy();\r\n        newpar.init(particle, 0, this.speed);\r\n        newpar.next = this.first.next;\r\n        this.first.next = newpar;\r\n    },\r\n\r\n    create: function() {\r\n        for (let i = 0; i < this.num; i++) {\r\n            console.debug(\"create\");\r\n            let newpar = cc.instantiate(this.Particle);\r\n            this.scheduleOnce(function() {\r\n                //newpar.destroy();\r\n            }, 0.1);\r\n            let x = (Math.random() - Math.random() / 2) * 2 * this.length;\r\n            newpar.setPosition(cc.v2(x, 2590, 0));\r\n            this.node.addChild(newpar);\r\n            this.createOne(newpar);\r\n        }\r\n\r\n    },\r\n\r\n\r\n    update(dt) {\r\n        let poi = this.first.next;\r\n        while (poi != null) {\r\n            poi.changespeed(this.target, this.mula);\r\n            poi.move();\r\n            poi = poi.next;\r\n        }\r\n    },\r\n});"]}