{"version":3,"sources":["assets\\scripts\\floorScript.js"],"names":["cc","Class","Component","properties","lastfloor","type","Node","spriteFrame2","SpriteFrame","spriteFrame3","spriteFrame4","spriteFrame5","spriteFrame6","spriteFrame7","spriteFrame8","spriteFrame9","spriteFrame10","world","state","target","onLoad","accelerate","speed","angleSpeed","barycenter1","node","x","barycenter2","bindnode","node1","node2","changeState","getComponent","active","changeState2","i","getbarycenter","getLastpos1","getLastpos2","changeSprite","id","self","spriteFrame","Sprite","start","update","dt","y","Math","abs","anchorX","anchorY","falldown","VeryPerfect","gameOver","angle"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        lastfloor: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        spriteFrame2: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n        spriteFrame3: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n        spriteFrame4: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n        spriteFrame5: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n        spriteFrame6: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n        spriteFrame7: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n        spriteFrame8: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n        spriteFrame9: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n        spriteFrame10: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n        world: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        state: 0, //1-4正常 5销毁 6直线下坠 7向左滚\r\n        target: cc.Node,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad() {\r\n        this.accelerate = 5000;\r\n        this.speed = 0;\r\n        this.angleSpeed = 0;\r\n        this.barycenter1 = this.node.x;\r\n        this.barycenter2 = this.node.x;\r\n    },\r\n\r\n    bindnode: function(node1, node2) {\r\n        this.lastfloor = node1;\r\n        this.world = node2;\r\n    },\r\n\r\n    changeState: function() {\r\n        if (this.state < 4) {\r\n            this.state += 1;\r\n            this.lastfloor.getComponent('floorScript').changeState();\r\n        } else if (this.state == 4) {\r\n            this.node.active = false;\r\n        }\r\n    },\r\n\r\n    changeState2: function(i) {\r\n        this.state = i;\r\n    },\r\n\r\n\r\n    getbarycenter: function() { //返回重心\r\n        return this.barycenter1;\r\n    },\r\n\r\n    getLastpos1: function() { //返回下层坐标\r\n        return this.lastfloor.x;\r\n    },\r\n\r\n    getLastpos2: function() { //返回下下层坐标\r\n        return this.lastfloor.getComponent(\"floorScript\").getLastpos1();\r\n    },\r\n\r\n    changeSprite: function(id) {\r\n        var self = this;\r\n        var spriteFrame;\r\n        switch (id) {\r\n            case 2:\r\n                spriteFrame = this.spriteFrame2;\r\n                break;\r\n            case 3:\r\n                spriteFrame = this.spriteFrame3;\r\n                break;\r\n            case 4:\r\n                spriteFrame = this.spriteFrame4;\r\n                break;\r\n            case 5:\r\n                spriteFrame = this.spriteFrame5;\r\n                break;\r\n            case 6:\r\n                spriteFrame = this.spriteFrame6;\r\n                break;\r\n            case 7:\r\n                spriteFrame = this.spriteFrame7;\r\n                break;\r\n            case 8:\r\n                spriteFrame = this.spriteFrame8;\r\n                break;\r\n            case 9:\r\n                spriteFrame = this.spriteFrame9;\r\n                break;\r\n            case 10:\r\n                spriteFrame = this.spriteFrame10;\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        self.node.getComponent(cc.Sprite).spriteFrame = spriteFrame;\r\n    },\r\n\r\n    start() {\r\n\r\n    },\r\n\r\n    update(dt) {\r\n        if (this.state == 0) {\r\n            if (this.node.y > 2740) {\r\n                this.speed += this.accelerate * dt;\r\n                this.node.y -= this.speed * dt;\r\n            } else {\r\n                if (Math.abs(this.lastfloor.x - this.node.x) >= 500) { //判断是否落空\r\n                    this.state = 6;\r\n                } else if (this.lastfloor.x - this.node.x > 250) { //向左滚\r\n                    this.state = 7;\r\n                    this.node.anchorX = (this.lastfloor.x - this.node.x) / 500;\r\n                    this.node.anchorY = 0; //重新设置锚点，基于锚点旋转\r\n                    this.node.x += 500 * this.node.anchorX - 250;\r\n                    this.node.y -= 150;\r\n                } else if (this.lastfloor.x - this.node.x < -250) { //向右滚\r\n                    this.state = 8;\r\n                    this.node.anchorX = 1 + (this.lastfloor.x - this.node.x) / 500;\r\n                    this.node.anchorY = 0; //重新设置锚点，基于锚点旋转\r\n                    this.node.x += 500 * this.node.anchorX - 250;\r\n                    this.node.y -= 150;\r\n                } else {\r\n                    this.barycenter1 = (this.node.x + this.lastfloor.x) / 2;\r\n                    this.barycenter2 = (this.node.x + 2 * this.lastfloor.getComponent(\"floorScript\").getbarycenter()) / 3;\r\n                    if (this.getLastpos2() - this.barycenter1 > 250 || this.lastfloor.getComponent(\"floorScript\").getLastpos2() - this.barycenter2 > 250) {\r\n                        this.world.getComponent('eventSystem').falldown(1);\r\n                    } else if (this.getLastpos2() - this.barycenter1 < -250 || this.lastfloor.getComponent(\"floorScript\").getLastpos2() - this.barycenter2 < -250) {\r\n                        this.world.getComponent('eventSystem').falldown(-1);\r\n                    } else {\r\n                        this.node.y = 2740;\r\n                    }\r\n                    if(Math.abs(this.lastfloor.x - this.node.x) <= 30){\r\n                        this.world.getComponent('eventSystem').VeryPerfect();\r\n                    }\r\n                }\r\n            }\r\n        } else if (this.state == 1) {\r\n            if (this.node.y > 2440) {\r\n                this.node.y -= 428.57 * dt;\r\n            } else {\r\n                this.node.y = 2440;\r\n            }\r\n        } else if (this.state == 2) {\r\n            if (this.node.y > 2140) {\r\n                this.node.y -= 428.57 * dt;\r\n            } else {\r\n                this.node.y = 2140;\r\n            }\r\n        } else if (this.state == 3) {\r\n            if (this.node.y > 1840) {\r\n                this.node.y -= 428.57 * dt;\r\n            } else {\r\n                this.node.y = 1840;\r\n            }\r\n        } else if (this.state == 4) {\r\n            if (this.node.y > 1540) {\r\n                this.node.y -= 428.57 * dt;\r\n            } else {\r\n                this.node.y = 1540;\r\n            }\r\n        } else if (this.state == 5) {\r\n\r\n        } else if (this.state == 6) {\r\n            this.world.getComponent('eventSystem').gameOver();\r\n            if (this.node.y > 1540) {\r\n                this.speed += this.accelerate * dt;\r\n                this.node.y -= this.speed * dt;\r\n            } else {\r\n                this.node.y = 1540;\r\n            }\r\n        } else if (this.state == 7) {\r\n            if (this.node.angle < 90) {\r\n                this.angleSpeed += 1000 * dt;\r\n                this.node.angle += this.angleSpeed * dt;\r\n            } else {\r\n                this.state = 6;\r\n            }\r\n        } else if (this.state == 8) {\r\n            if (this.node.angle > -90) {\r\n                this.angleSpeed += 1000 * dt;\r\n                this.node.angle -= this.angleSpeed * dt;\r\n            } else {\r\n                this.state = 6;\r\n            }\r\n        }\r\n    },\r\n});"]}