{"version":3,"sources":["assets\\scripts\\eventSystem.js"],"names":["cc","Class","Component","properties","scoreDisplay","type","Label","background","Node","gameOverPanle","Layout","gameOverPanle_failed","gameOverScore","floorPrefab","Prefab","fakefloor","rope","lastfloor","particlePrefab","particlePrefab2","particlePrefab3","layoutStart","time","music","AudioClip","effect","effect1","perfect","flag","onLoad","isPerfect","flag_number","flag_start","isOver","count","score","fallside","angleSpeed","angleTimer","shakeAnglespeed","active","node","on","event","spawnNewFloor","bind","start","newfloor","instantiate","addChild","getComponent","bindnode","changeSprite","id","setPosition","convertToWorldSpaceAR","v2","Math","sin","angle","PI","hideFakeFloor","self","console","debug","scheduleOnce","newPar","current","audioEngine","play","newPar2","startdown","changeWaveSpeed","changeScore","newPar3","current1","changeState","changeTexture","changeSpeed","VeryPerfect","string","gameOver","falldown","i","LayoutOn","LayoutOff","buttonOne","buttonTwo","choice","iniTime","schedule","countdown","log","restar","director","loadScene","update","dt","cos"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        scoreDisplay: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        background: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        gameOverPanle: {\r\n            default: null,\r\n            type: cc.Layout\r\n        },\r\n        gameOverPanle_failed: {\r\n            default: null,\r\n            type: cc.Layout\r\n        },\r\n        gameOverScore: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        floorPrefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n\r\n        fakefloor: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n\r\n        rope: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n\r\n        lastfloor: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n\r\n        particlePrefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n\r\n        particlePrefab2: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n\r\n        particlePrefab3: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n\r\n        layoutStart: {\r\n            default: null,\r\n            type: cc.Layout\r\n        },\r\n\r\n        time: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        music: {\r\n            default: null,\r\n            type: cc.AudioClip\r\n        },\r\n        effect: {\r\n            default: null,\r\n            type: cc.AudioClip\r\n        },\r\n        effect1: {\r\n            default: null,\r\n            type: cc.AudioClip\r\n        },\r\n\r\n        perfect: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n\r\n\r\n        flag: true,\r\n\r\n    },\r\n\r\n    onLoad: function() {\r\n        // this.choice = true;\r\n        this.isPerfect = false;\r\n        this.flag_number = 0;\r\n        this.flag_start = false;\r\n        this.isOver = false;\r\n        this.count = 60;\r\n        this.score = 0;\r\n        this.fallside = 0;\r\n        this.angleSpeed = 0;\r\n        this.angleTimer = 0;\r\n        this.shakeAnglespeed = 0;\r\n        this.perfect.active = false;\r\n        this.node.on('touchend', function(event) {\r\n            if (this.flag && !this.isOver && this.flag_start) {\r\n                this.spawnNewFloor();\r\n            }\r\n        }.bind(this));\r\n        this.node.on('mousedown', function(event) {\r\n            if (this.flag && !this.isOver && this.flag_start) {\r\n                this.spawnNewFloor();\r\n            }\r\n        }.bind(this));\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n    start() {\r\n\r\n    },\r\n\r\n    spawnNewFloor: function() {\r\n        // 使用给定的模板在场景中生成一个新节点\r\n        var newfloor = cc.instantiate(this.floorPrefab);\r\n        this.node.addChild(newfloor);\r\n        newfloor.getComponent('floorScript').bindnode(this.lastfloor, this.node);\r\n        newfloor.getComponent('floorScript').changeSprite(this.fakefloor.getComponent('fakefloorScript').id);\r\n        this.lastfloor = newfloor;\r\n        newfloor.setPosition(this.fakefloor.convertToWorldSpaceAR(cc.v2(-630 + 3300 * Math.sin(this.node.angle * Math.PI / 180), 1840)));\r\n        this.hideFakeFloor();\r\n\r\n    },\r\n\r\n    hideFakeFloor: function() {\r\n        this.flag = false;\r\n        var self = this;\r\n        console.debug(\"0\");\r\n        this.scheduleOnce(function() {\r\n            var newPar = cc.instantiate(self.particlePrefab);\r\n            this.current = cc.audioEngine.play(this.effect, false, 0.3); //\r\n            self.node.addChild(newPar);\r\n            newPar.setPosition(cc.v2(0, 2590, 0));\r\n            var newPar2 = cc.instantiate(self.particlePrefab2);\r\n            self.node.addChild(newPar2);\r\n            newPar2.setPosition(cc.v2(0, 2590, 0));\r\n            console.debug('particles');\r\n        }, 0.4)\r\n\r\n        this.background.getComponent('BackChange').scheduleOnce(function() {\r\n            this.startdown();\r\n            self.changeWaveSpeed();\r\n            if (self.isPerfect) {\r\n                self.changeScore();\r\n                console.debug(\"perfect\");\r\n                var newPar3 = cc.instantiate(self.particlePrefab3);\r\n                self.node.addChild(newPar3);\r\n                newPar3.setPosition(cc.v2(0, 3300, 0));\r\n                console.debug('flower');\r\n\r\n\r\n                //this.getComponent('GreatWork').scheduleOnce(function() {\r\n                //console.debug(\"create particle\");\r\n                //this.create();\r\n                //}, 0.4)\r\n            }\r\n            self.isPerfect = false;\r\n\r\n        }, 0.7);\r\n        //console.debug(\"1\");\r\n\r\n        this.scheduleOnce(function() {\r\n            if (self.isPerfect) {\r\n                this.current1 = cc.audioEngine.play(this.effect1, false, 0.5); //第二个音效\r\n                this.perfect.active = false;\r\n            }\r\n        }, 0.7)\r\n\r\n\r\n        this.lastfloor.getComponent('floorScript').scheduleOnce(function() {\r\n            this.changeState();\r\n        }, 0.7);\r\n        this.fakefloor.getComponent('fakefloorScript').changeTexture(1);\r\n        this.fakefloor.getComponent('fakefloorScript').scheduleOnce(function() {\r\n            // 这里的 this 指向 component\r\n            this.changeTexture(2);\r\n            if (!self.isOver) {\r\n                self.flag = true;\r\n                self.changeScore();\r\n            }\r\n        }, 0.7);\r\n    },\r\n\r\n    changeWaveSpeed: function() {\r\n        if (this.score <= 50) {\r\n            this.rope.getComponent('pendulumScript').changeSpeed(this.score / 20 + 1.5);\r\n            this.fakefloor.getComponent('pendulumScript').changeSpeed(this.score / 20 + 1.5);\r\n        }\r\n    },\r\n\r\n\r\n    VeryPerfect: function() {\r\n\r\n        this.perfect.active = true;\r\n        this.isPerfect = true;\r\n    },\r\n\r\n\r\n    changeScore: function() {\r\n        this.score++;\r\n        this.scoreDisplay.string = 'Score: ' + this.score;\r\n    },\r\n\r\n    gameOver: function() {\r\n        if (!this.isOver) {\r\n            this.isOver = true;\r\n        }\r\n        if (this.flag_number == 0) {\r\n            this.scheduleOnce(function() {\r\n                this.gameOverPanle.node.active = true;\r\n                this.gameOverScore.string = this.score;\r\n                this.gameOverScore.node.active = true;\r\n                console.debug(\"panel_end\");\r\n            }, 1.5)\r\n        }\r\n        if (this.flag_number == 1) {\r\n            this.scheduleOnce(function() {\r\n                this.gameOverPanle_failed.node.active = true;\r\n                this.gameOverScore.string = this.score;\r\n                this.gameOverScore.node.active = true;\r\n                console.debug(\"panel_fail\");\r\n            }, 1.5)\r\n        }\r\n    },\r\n\r\n    falldown: function(i) {\r\n        if (!this.isOver) {\r\n            this.fallside = i;\r\n            // this.choice = false;\r\n            this.gameOver();\r\n        }\r\n    },\r\n\r\n    LayoutOn: function() {\r\n        this.layoutStart.node.active = true;\r\n\r\n    },\r\n\r\n    LayoutOff: function() {\r\n        this.layoutStart.node.active = false;\r\n        this.flag_start = true;\r\n        // console.debug(\"close\");\r\n    },\r\n\r\n    buttonOne: function() {\r\n        this.LayoutOff();\r\n        this.time.string = '';\r\n        // console.debug('button one')\r\n    },\r\n\r\n    buttonTwo: function() {\r\n        this.flag_number = 1;\r\n        this.choice = false;\r\n        this.LayoutOff();\r\n        this.iniTime();\r\n    },\r\n\r\n    iniTime: function() {\r\n        // if (this.count >= 0) {\r\n        this.schedule(function() {\r\n            this.countdown();\r\n        }, 1);\r\n        // }\r\n    },\r\n\r\n    countdown: function() {\r\n        if (this.count >= 1) {\r\n            this.count = this.count - 1;\r\n            this.time.string = this.count + 's';\r\n            cc.log(\"countdown:\" + this.count);\r\n        } else {\r\n            this.flag_number = 0;\r\n            this.gameOver();\r\n        }\r\n    },\r\n\r\n    restar: function() {\r\n        this.gameOverScore.node.active = false;\r\n        cc.director.loadScene('1');\r\n    },\r\n\r\n    update(dt) {\r\n        if (this.fallside == 1) {\r\n            if (this.node.angle < 90) {\r\n                this.angleSpeed += 50 * dt;\r\n                this.node.angle += this.angleSpeed * dt;\r\n            }\r\n        } else if (this.fallside == -1) {\r\n            if (this.node.angle > -90) {\r\n                this.angleSpeed += 50 * dt;\r\n                this.node.angle -= this.angleSpeed * dt;\r\n            }\r\n        } else if (this.score >= 5 && this.score <= 35) {\r\n            this.angleTimer += dt;\r\n            this.shakeAnglespeed = Math.cos(this.angleTimer);\r\n            this.node.angle += this.shakeAnglespeed * (this.score / 5) * dt;\r\n        } else if (this.score >= 35) {\r\n            this.angleTimer += dt;\r\n            this.shakeAnglespeed = Math.cos(this.angleTimer);\r\n            this.node.angle += this.shakeAnglespeed * 5 * dt;\r\n        }\r\n    },\r\n});"]}