{"version":3,"sources":["GreatWork.js"],"names":["cc","Class","extends","Component","properties","Particle","default","type","Prefab","target","Node","speed","deviation","num","mula","length","first","phy","px","py","vx","vy","ax","ay","particle","next","move","x","y","changespeed","targetx","targety","dx","dy","init","midx","console","debug","Math","random","start","createOne","newpar","create","i","instantiate","scheduleOnce","setPosition","v2","node","addChild","update","dt","poi"],"mappings":"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","file":"GreatWork.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        Particle: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n        target: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        speed: 0,\r\n        deviation: 0,\r\n        num: 0,\r\n        mula: 0,\r\n        length: 0,\r\n        first: null,\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n    phy: function() {\r\n\r\n        this.px = 0;\r\n        this.py = 0;\r\n        this.vx = 0;\r\n        this.vy = 0;\r\n        this.ax = 0;\r\n        this.ay = 0;\r\n        this.particle = null;\r\n        this.next = null;\r\n        this.move = function() {\r\n            this.px += this.vx;\r\n            this.py += this.vy;\r\n\r\n            this.particle.x = this.px;\r\n            this.particle.y = this.py;\r\n        }\r\n        this.changespeed = function(target, mula) {\r\n            let targetx = target.x;\r\n            let targety = target.y;\r\n            //console.debug(targetx);\r\n            //console.debug(this.px);\r\n            //console.debug(targetx-this.px);\r\n\r\n            let dx = targetx - this.px;\r\n            let dy = targety - this.py;\r\n            //console.debug(dx*dx+dy*dy);\r\n            //console.debug(dx*dx/(dx*dx+dy*dy));\r\n            //console.debug(dx*dx/(dx*dx+dy*dy)*mula);\r\n            this.ax = dx * dx / (dx * dx + dy * dy) * mula;\r\n            this.ay = dy * dy / (dx * dx + dy * dy) * mula;\r\n            //console.debug(this.ax,this.ay);\r\n            this.vx += this.ax;\r\n            this.vy += this.ay;\r\n        }\r\n        this.init = function(particle, midx, speed) {\r\n            console.debug(\"init\");\r\n            this.particle = particle;\r\n            this.px = particle.x;\r\n            this.py = particle.y;\r\n            this.vx = (this.px - midx) * Math.random() * speed;\r\n            this.vy = this.vy * Math.random() * speed * (-1);\r\n        }\r\n\r\n    },\r\n    start() {\r\n        this.first = new this.phy(this.Particle);\r\n        console.debug(\"start\");\r\n    },\r\n\r\n    createOne: function(particle) {\r\n        console.debug(\"createOne\");\r\n        var newpar = new this.phy();\r\n        newpar.init(particle, 0, this.speed);\r\n        newpar.next = this.first.next;\r\n        this.first.next = newpar;\r\n    },\r\n\r\n    create: function() {\r\n        for (let i = 0; i < this.num; i++) {\r\n            console.debug(\"create\");\r\n            let newpar = cc.instantiate(this.Particle);\r\n            this.scheduleOnce(function() {\r\n                //newpar.destroy();\r\n            }, 0.1);\r\n            let x = (Math.random() - Math.random() / 2) * 2 * this.length;\r\n            newpar.setPosition(cc.v2(x, 2590, 0));\r\n            this.node.addChild(newpar);\r\n            this.createOne(newpar);\r\n        }\r\n\r\n    },\r\n\r\n\r\n    update(dt) {\r\n        let poi = this.first.next;\r\n        while (poi != null) {\r\n            poi.changespeed(this.target, this.mula);\r\n            poi.move();\r\n            poi = poi.next;\r\n        }\r\n    },\r\n});"]}